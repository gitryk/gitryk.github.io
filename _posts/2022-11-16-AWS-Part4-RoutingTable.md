---
title: AWS Infra / Part4. Routing Table 설정
date: 2022-11-16 14:50:00 +0900
categories: [AWS, 2Tier 아키텍쳐 구축]
tags: [AWS, Routing Table]     # TAG names should always be lowercase
typora-root-url: ../
---
# Intro

[Part 2. 서브넷](/posts/AWS-Part2-Subnet/)과 [Part 3. 인터넷 게이트웨이](/posts/AWS-Part3-IGW/) 를 보셨다면, 

이번엔 논리적으로 라우팅 테이블을 설정하여 실질적인 구역을 나눌 차례 입니다. 

<br>

# 라우팅 테이블이란?

> *라우팅 테이블*에는 서브넷 또는 게이트웨이의 네트워크 트래픽이 전송되는 위치를 결정하는 라우팅이라는 규칙 세트가 포함되어 있습니다. - *AWS Document*

라우팅 테이블은 지도 같은 개념이라고 보면 될 것 같습니다.

아직 VPC내에 특별한 인스턴스들이 존재하지 않지만, 나중에 배치했을때 해당 인스턴스로 가려면

어떻게 가야되는지 알려주는 역할이라고 보시면 될 것 같습니다.

<br>

# 실전

## Public 서브넷 라우팅 테이블 생성

![01](/assets/post/2022-11-16-AWS-Part4-RoutingTable/01.png)

VPC 대시보드에서 **라우팅 테이블**을 클릭 합니다

<br>

![02](/assets/post/2022-11-16-AWS-Part4-RoutingTable/02.png)

기본적으로 아무것도 지정이 되어있지 않은 라우팅 테이블이 존재 합니다.

이 테이블을 수정해도 되지만 만들어보고 지우는 실습을 위해 일단 건드리지 않고

**라우팅 테이블 생성**을 클릭합니다.

<br>

![03](/assets/post/2022-11-16-AWS-Part4-RoutingTable/03.png)

이름과 라우팅 테이블이 속할 VPC를 선택 합니다.

이번에는 Public Subnet에 대한 테이블을 생성할 것이라 위와 같이 기입하였습니다.

이름과 VPC를 지정했으면 **라우팅 테이블 생성** 버튼을 누릅니다.

<br>

![04](/assets/post/2022-11-16-AWS-Part4-RoutingTable/04.png)

생성이 완료 되었으면 위와 같은 창이 뜹니다.

만든 Subnet들을 소속시키기 위해 **서브넷 연결**을 클릭 후 나오는 **서브넷 연결 편집**을 선택 합니다.

<br>

![05](/assets/post/2022-11-16-AWS-Part4-RoutingTable/05.png)

서브넷 생성 파트에서 만들어둔 8개의 서브넷들이 보입니다.

Public Subnet용으로 만들었던 두개의 서브넷을 선택 후 **연결 저장**을 누릅니다.

<br>

![06](/assets/post/2022-11-16-AWS-Part4-RoutingTable/06.png)

위 처럼 만든 라우팅 테이블에 서브넷들이 등록 되었습니다.

사실 여기까지는 라우팅 테이블에 서브넷을 등록만 시킨 단계 입니다.

아직 이 라우팅 테이블로 서브넷이 Public 서브넷이 되어있는 상태는 아닙니다.

계속 진행 합니다.

<br>

![07](/assets/post/2022-11-16-AWS-Part4-RoutingTable/07.png)

이번에는 **라우팅** 탭을 클릭 합니다.

그 후 나오는 **라우팅 편집** 버튼을 클릭합니다.

<br>

![08](/assets/post/2022-11-16-AWS-Part4-RoutingTable/08.png)

기본 라우팅이 하나 생성 되어있습니다. 

이 라우팅 테이블을 퍼블릭용으로 만들어 주기 위해 **라우팅 추가** 버튼을 클릭 합니다.

<br>

![09](/assets/post/2022-11-16-AWS-Part4-RoutingTable/09.png)

버튼을 눌렀다면 한 줄이 추가되고 그곳에 값을 기입할 수 있습니다.

**첫번째 대상**을 **0.0.0.0/0**으로 선택 합니다. 그 후 **두번째 대상**은 **인터넷 게이트웨이**를 선택 합니다.

> 위에서는 전부 대상이라고 되어있지만, 실제로는 처음은 **Destination**, 두번째는 **Target** 입니다.
>
> 즉, 목적지가 0.0.0.0/0인 패킷은 인터넷 게이트웨이를 통해 가라는 뜻 입니다.

그러면 자동으로 만들어 둔 인터넷 게이트웨이 내역이 표시 됩니다.

[앞 전 파트에서 만들었던 인터넷 게이트웨이](/posts/AWS-Part3-IGW/)를 선택하고 **변경사항 저장**을 클릭합니다.

<br>

![10](/assets/post/2022-11-16-AWS-Part4-RoutingTable/10.png)

위와 같이 적용이 된 것을 알 수 있습니다.

인터넷 게이트웨이와 퍼블릭 서브넷이 포함된 라우팅 테이블이 연동이 되었습니다.

이제 PublicSN 라우팅 테이블에 포함된 두개의 서브넷에 있는 구성 요소들은 바깥과 통신이 가능합니다.

<br>

## (선택)라우팅 테이블 삭제하기

이번 파트는 딱히 따라할 필요는 없는 부분 입니다.

하지만 라우팅 테이블을 삭제할 때 필요한 조건들과 함께 어떻게 삭제하는지 알아보겠습니다.

이를 보여드리기 위해 기본적으로 생성되어 있는 라우팅 테이블을 삭제 해보겠습니다.

<br>

![11](/assets/post/2022-11-16-AWS-Part4-RoutingTable/11.png)

우선 삭제 조건에는 **기본 라우팅 테이블이 아닐 것**과 **연동될 요소가 없을 것**이 조건 입니다.

후자는 만족하지만 삭제될 기본 라우팅 테이블은 원래 기본으로 설정 되어 있기 때문에 삭제가 불가능 합니다.

이를 위해 PublicSN을 기본 테이블로 설정 하겠습니다.

방금 만들어둔 라우팅 테이블을 선택 후 작업 > **기본 라우팅 테이블 설정**을 클릭 합니다.

<br>

![12](/assets/post/2022-11-16-AWS-Part4-RoutingTable/12.png)

위와 같은 경고가 팝업 됩니다. **명시적으로 연결되어있지 않은~** 이란 경고가 뜨게 됩니다.

다음에 만들 Private 서브넷용 라우팅 테이블을 만들면서 모든 서브넷을 명시적으로 모두 구분 할 것이기 때문에,

해당이 되지 않지만 만약 추가로 서브넷을 생성하고 해당 서브넷을 목적에 맞는 라우팅 테이블에 소속시키지

않는다면, 현재 세팅으로는 **기본적으로 개방된 서브넷이 되기 때문에 주의해야 됩니다.**

추후에 만들 Private 서브넷용 테이블을 기본으로 설정 하거나 삭제 안하셔도 된다는 걸 알려 드립니다.

<br>

![13](/assets/post/2022-11-16-AWS-Part4-RoutingTable/13.png)

이름이 지정되지 않은 라우팅 테이블이 기본 라우팅 테이블에서 해제가 되었기 때문에 삭제 할 수 있습니다.

선택 후 작업 > **라우팅 테이블 삭제**를 클릭 합니다.

<br>

![14](/assets/post/2022-11-16-AWS-Part4-RoutingTable/14.png)

별도로 연동 된것이 없기 때문에 바로 삭제가 가능합니다. **삭제** 버튼을 눌러 삭제 합니다.

삭제하는 법과 기본 라우팅 테이블을 지정하는것을 예시로 보여드린 것이기 때문에 

이번 파트는 따라 안하셔도 무방합니다.

<br>

## Private 서브넷 라우팅 테이블 생성

![15](/assets/post/2022-11-16-AWS-Part4-RoutingTable/15.png)

Public과 동일하게 진행 됩니다. 이름과 VPC를 지정후 **라우팅 테이블 생성**을 클릭 합니다.

<br>

![16](/assets/post/2022-11-16-AWS-Part4-RoutingTable/16.png)

이번에도 **서브넷 연결** 탭을 클릭 후 **서브넷 연결 편집**을 클릭 합니다.

<br>

![17](/assets/post/2022-11-16-AWS-Part4-RoutingTable/17.png)

이번에는 Private 서브넷중 2a 가용영역에 있는 서브넷들을 선택 후 **연결 저장**을 클릭 합니다.

마찬가지로 **PrivateSNc 라우팅 테이블을 생성**하여 2c 가용영역에 있는 서브넷 들을 포함 시킵니다.

현 파트에서는 여기까지 하시면 됩니다.

<br>

## 결과 확인

![18](/assets/post/2022-11-16-AWS-Part4-RoutingTable/18.png)

이렇게 세개의 라우팅 테이블이 생성 되었습니다.

<br>

# Outro

이번에는 서브넷들을 논리적으로 나누기 위한 라우팅 테이블 설정을 하였습니다.

하지만 사실 완전히 끝난 것이 아닙니다. Private 서브넷도 바깥과 통신을 해야 할때가 분명 있습니다.

패키지 업데이트나 설치 등을 할때는 인터넷에 접속이 가능해야 하니 말이죠

글이 길어지는 것도 있고 별도의 배치를 해야하기 때문에 따로 문서를 분리 했습니다.

다음 파트는 [Part 5. NAT Gateway](/posts/AWS-Part5-NATGateway/) 입니다.